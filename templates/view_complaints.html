{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2>View Complaints</h2>
    <ul id="complaints-list">
        <!-- Complaints will be populated here -->
    </ul>
</div>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const response = await fetch('/view-complaints/', {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${document.cookie.replace(/(?:(?:^|.*;\s*)access_token\s*=\s*([^;]*).*$)|^.*$/, "$1")}`
            }
        });
        const data = await response.json();
        if (response.ok) {
            const list = document.getElementById('complaints-list');
            data.complaints.forEach(complaint => {
                const item = document.createElement('li');
                item.textContent = `${complaint.description} - ${complaint.timestamp}`;
                list.appendChild(item);
            });
        } else {
            alert(data.detail);
        }
    });
</script>
{% endblock %}